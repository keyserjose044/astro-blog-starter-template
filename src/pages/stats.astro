---
import Layout from '../layouts/BlogPost.astro';
import StatsGraphs from '../components/StatsGraphs.astro';

const stats = [
  {
    icon: 'üèÉ‚Äç‚ôÇÔ∏è',
    label: 'Running',
    key: 'runningMiles',
    value: '445',
    note: 'Lifetime logged running distance.',
  },
  {
    icon: 'üìî',
    label: 'Diary Words',
    key: 'diaryWords',
    value: '100000',
    note: 'Words written in my diary.',
  },
  {
    icon: 'üé∏',
    label: 'Guitar Hours',
    key: 'guitarHours',
    value: '419',
    note: 'Deliberate practice hours.',
  },
  {
    icon: 'üìö',
    label: 'Books Finished',
    key: 'booksCount',
    value: '400',
    note: 'Across physical, ebooks, and audiobooks.',
  },
];

const prohibitions = [
  { icon: 'üö´', title: 'No Alcohol', subtitle: 'Clarity > Numbing', description: 'Alcohol blunts awareness, recovery, and discipline. I don‚Äôt drink, ever.' },
  { icon: 'üìµ', title: 'No Social Media Scrolling', subtitle: 'Creation > Consumption', description: 'I use social media only for posting value ‚Äî never for browsing feeds.' },
  { icon: '‚öîÔ∏è', title: 'No Drama or Gossip', subtitle: 'Focus > Noise', description: 'Interpersonal chaos kills deep work, so I stay clear of it.' },
  { icon: 'üõå', title: 'No Oversleeping', subtitle: 'Structure > Drift', description: 'Morning momentum sets the tone. I don‚Äôt sleep in.' },
  { icon: 'ü•¶', title: 'No Junk Food Bingeing', subtitle: 'Energy > Impulse', description: 'Clean fuel = clean thinking and better performance.' },
  { icon: 'üéÆ', title: 'No Mindless Entertainment', subtitle: 'Deliberate Leisure > Passive Dopamine', description: 'No bingewatching or doomscrolling ‚Äî only intentional fun.' }
];

const projects = [
  { title: 'LifeLoggerz Blog & Systems', blurb: 'Documenting the Google Sheets + Python ecosystem that runs my life.', status: 'WIP', tags: ['Writing', 'Meta-Tracking', 'Systems'] },
  { title: 'Guitar & Music Study', blurb: 'Structured practice on flamenco, mariachi, and classical pieces.', status: 'WIP', tags: ['Guitar', 'Practice', 'Art'] },
  { title: 'Lab Automation Scripts', blurb: 'Python tools for calorimetry, TGA, Load‚ÄìCMOD, and research workflows.', status: 'WIP', tags: ['Python', 'Research', 'Automation'] },
  { title: 'Research Paper Pipeline', blurb: 'From reading to databasing figures, mix designs, and results.', status: 'WIP', tags: ['Research', 'Knowledge Base'] }
];
---

<Layout
  title="Stats & Systems"
  description="A numbers-first snapshot of who I am, what I track, and the rules I live by."
  pubDate="2025-11-17"
  heroImage="/images/about-lifeloggerz.gif"
  wide
  showViews={false}
>
  <div class="stats-page">
    <p class="intro">
      This page is my extended ‚ÄúAbout‚Äù ‚Äî not just who I am, but how I live:
      the numbers I track, the rules I follow, and the projects I‚Äôm actively
      building.
    </p>

    <section class="section" aria-labelledby="snapshot-heading">
      <h2 id="snapshot-heading">üìä Snapshot Stats</h2>
      <p class="section-hint">
        High-level stats pulled from my tracking sheets and logs. Not exhaustive
        ‚Äî just a glimpse.
      </p>
      <div class="stats-grid">
        {stats.map((item) => (
          <article
            class="card card--stat"
            data-stat-key={item.key}
          >
            <div class="icon-bubble">{item.icon}</div>
            <div class="stat-label">{item.label}</div>
            <div class="stat-value">
              {item.value}
            </div>
            {item.note && <p class="muted">{item.note}</p>}
          </article>
        ))}
      </div>
    </section>

    <StatsGraphs />

    <section class="section" aria-labelledby="prohibitions-heading">
      <h2 id="prohibitions-heading">üö´ Prohibitions</h2>
      <p class="section-hint">
        A lot of my productivity comes from what I <strong>don‚Äôt</strong> do.
        These constraints protect my time, focus, and identity.
      </p>
      <div class="stats-grid">
        {prohibitions.map((item) => (
          <article class="card card--prohibition">
            <div class="icon-bubble">{item.icon}</div>
            <h3>{item.title}</h3>
            <p class="subtitle">{item.subtitle}</p>
            <p class="muted">{item.description}</p>
          </article>
        ))}
      </div>
      <p class="warning">
        ‚ö†Ô∏è Over time, you can become so productive that you end up scratching
        your head, wondering what to do next.
      </p>
    </section>

    <section class="section" aria-labelledby="projects-heading">
      <h2 id="projects-heading">üß™ Current Projects & Hobbies</h2>
      <p class="section-hint">
        What I‚Äôm actively building or practicing outside of classes and lab
        work. Themes stay similar: systems, learning, and craft.
      </p>
      <div class="stats-grid">
        {projects.map((p) => (
          <article class="card card--project">
            <div class="project-header">
              <span class="status-badge">{p.status}</span>
            </div>
            <h3>{p.title}</h3>
            <p class="muted">{p.blurb}</p>
            {p.tags && p.tags.length > 0 && (
              <p class="tags">#{p.tags.join('  #')}</p>
            )}
          </article>
        ))}
      </div>
    </section>
  </div>

  <script>
    (function () {
      const url = 'https://script.google.com/macros/s/AKfycbyPQznk53znPQ8TgGTcK9tuwq-Vw5deN1YRpbmTHb0OOKHwTu9b1XBJqQuGh7PXh6pKHA/exec';

      async function loadStats() {
        try {
          console.log('[Stats] Fetching from GAS‚Ä¶');
          const res = await fetch(url);
          if (!res.ok) {
            console.error('[Stats] Fetch failed with status', res.status);
            return;
          }

          const data = await res.json();
          console.log('[Stats] JSON received:', data);

          if (!data) return;

          var elements = document.querySelectorAll('[data-stat-key]');
          for (var i = 0; i < elements.length; i++) {
            var el = elements[i];
            var key = el.getAttribute('data-stat-key');
            if (key && data[key] !== undefined && data[key] !== null) {
              el.textContent = String(data[key]);
            }
          }
        } catch (err) {
          console.error('[Stats] Failed to load stats', err);
        }
      }

      if (typeof window !== 'undefined') {
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
          loadStats();
        } else {
          window.addEventListener('DOMContentLoaded', loadStats);
        }
      }
    })();
  </script>

  <style is:global>
    .stats-page {
      max-width: 960px;
      margin: 0 auto;
    }

    .stats-page .intro {
      text-align: center;
      margin-bottom: 2rem;
      color: #4b5563;
    }

    .section {
      margin-top: 3rem;
    }

    .section h2 {
      text-align: center;
      margin-bottom: 0.5rem;
    }

    .section-hint {
      text-align: center;
      margin: 0 auto 1.75rem;
      max-width: 640px;
      color: #6b7280;
      font-size: 0.95rem;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
    }

    @media (max-width: 640px) {
      .stats-grid {
        grid-template-columns: 1fr;
      }

      .section {
        margin-top: 2.25rem;
      }
    }

    .card {
      background: #ffffff;
      border-radius: 18px;
      border: 1px solid #e5e7eb;
      padding: 18px 16px 16px;
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.03);
      width: 100%;
      box-sizing: border-box;
    }

    .card--stat,
    .card--prohibition {
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }

    .icon-bubble {
      width: 60px;
      height: 60px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      margin-bottom: 0.35rem;
      background: #0f172a;
      color: #ffffff;
    }

    .stat-label {
      font-weight: 600;
      font-size: 0.95rem;
    }

    .card--prohibition h3 {
      margin: 0.25rem 0 0.1rem;
      font-size: 0.95rem;
      font-weight: 600;
    }

    .stat-value {
      font-size: 1.2rem;
      font-weight: 800;
    }

    .subtitle {
      font-size: 0.9rem;
      color: #6b7280;
      font-weight: 500;
      margin: 0;
    }

    .muted {
      margin-top: 0.4rem;
      font-size: 0.9rem;
      color: #4b5563;
    }

    .warning {
      margin-top: 2rem;
      text-align: center;
      font-style: italic;
      color: #6b7280;
      max-width: 640px;
      margin-inline: auto;
    }

    .card--project h3 {
      margin: 0.25rem 0 0.35rem;
      font-size: 1rem;
      font-weight: 700;
    }

    .tags {
      margin: 0.35rem 0 0;
      font-size: 0.85rem;
      color: #6b7280;
    }

    .project-header {
      display: flex;
      justify-content: flex-end;
    }

    .status-badge {
      font-size: 0.75rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: #e0ecff;
      color: #1d4ed8;
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }
  </style>
</Layout>
